<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Routine Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideIn {
    from { 
        transform: translateY(-20px);
        opacity: 0;
    }
    to { 
        transform: translateY(0);
        opacity: 1;
    }
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.animate-fade-in {
    animation: fadeIn 0.5s ease-out;
}

.animate-slide-in {
    animation: slideIn 0.5s ease-out;
}

.loader {
    border: 5px solid #f3f3f3;
    border-top: 5px solid #3498db;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
}

.routine-item {
    transition: all 0.3s ease;
}

.routine-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.icon-container {
    transition: all 0.3s ease;
}

.routine-item:hover .icon-container {
    transform: scale(1.1);
}

    </style>

</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-100 dark:from-gray-900 dark:to-gray-800 text-gray-800 dark:text-white min-h-screen">
    <div id="app" class="container mx-auto p-8 max-w-4xl">
        <!-- Form Section -->
        <div id="formSection" class="bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8 animate-fade-in transition-all duration-300 ease-in-out">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold mb-2 text-blue-600 dark:text-blue-400">AI-Powered Routine Generator</h1>
                <p class="text-gray-600 dark:text-gray-400">Fill in your details to create your perfect AI-generated routine</p>
            </div>
            <form id="routineForm" class="space-y-6">
                <!-- ... (keep the form fields as they were in the previous version) ... -->
                <div class="text-center">
                    <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                        Generate AI Routine
                    </button>
                </div>
            </form>
        </div>

        <!-- Loading Section -->
        <div id="loadingSection" class="hidden">
            <div class="card bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8 animate-fade-in">
                <div class="flex flex-col items-center justify-center h-64">
                    <div class="loader mb-4"></div>
                    <h2 class="text-xl font-semibold text-blue-600 dark:text-blue-400">Creating Your AI-Powered Routine</h2>
                    <p class="text-gray-600 dark:text-gray-400">Our AI is generating your personalized routine...</p>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden">
            <div class="card bg-white dark:bg-gray-800 shadow-lg rounded-lg overflow-hidden animate-fade-in">
                <div class="p-6 space-y-1 text-center bg-gradient-to-r from-blue-500 to-purple-600">
                    <h1 id="routineTitle" class="text-3xl font-bold text-white"></h1>
                    <p id="routineSubtitle" class="text-blue-100"></p>
                </div>
                <div class="p-6">
                    <div class="space-y-6">
                        <h2 class="text-2xl font-semibold text-center mb-6 text-blue-600 dark:text-blue-400">Your AI-Generated Daily Schedule</h2>
                        <div id="routineItems" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
                    </div>
                </div>
                <div class="p-6 flex justify-center">
                    <button id="backToForm" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                        Generate New Routine
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
lucide.createIcons();

// Helper function to generate time options
function generateTimeOptions() {
    const times = [];
    for (let i = 0; i < 24; i++) {
        for (let j = 0; j < 60; j += 30) {
            const hour = i.toString().padStart(2, '0');
            const minute = j.toString().padStart(2, '0');
            times.push(`${hour}:${minute}`);
        }
    }
    return times;
}

// Populate time dropdowns
const timeOptions = generateTimeOptions();
const sleepTimeSelect = document.getElementById('sleepTime');
const wakeTimeSelect = document.getElementById('wakeTime');
timeOptions.forEach(time => {
    sleepTimeSelect.add(new Option(time, time));
    wakeTimeSelect.add(new Option(time, time));
});

// Form submission handler
document.getElementById('routineForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData(e.target);
    const userData = Object.fromEntries(formData.entries());

    // Check if routine already exists in localStorage
    const existingRoutine = localStorage.getItem('userRoutine');
    if (existingRoutine) {
        displayRoutine(JSON.parse(existingRoutine));
        return;
    }

    // Show loading screen
    document.getElementById('formSection').classList.add('hidden');
    document.getElementById('loadingSection').classList.remove('hidden');

    // Call ChatGPT API to generate routine
    const routine = await generateRoutineWithChatGPT(userData);

    // Store routine in localStorage
    localStorage.setItem('userRoutine', JSON.stringify(routine));

    // Display routine
    displayRoutine(routine);
});

// Function to call ChatGPT API and generate routine
async function generateRoutineWithChatGPT(userData) {
    // Prepare the prompt for ChatGPT
    const prompt = `Generate a daily routine for a ${userData.age}-year-old ${userData.occupation} named ${userData.name}. 
    They usually sleep at ${userData.sleepTime} and wake up at ${userData.wakeTime}. 
    Their goals are: ${userData.goals}. 
    Additional information: ${userData.additionalInfo}. 
    Please provide the routine as a JSON object with the following structure:
    {
        "title": "string",
        "subtitle": "string",
        "iconWord": "string",
        "schedule": [
            {
                "time": "string",
                "activity": "string",
                "icon": "string"
            },
            ...
        ]
    }
    Use appropriate Lucide icon names for the "icon" field. The "iconWord" should be a single word that represents the overall theme of the routine.`;

    // API call configuration
    const apiUrl = 'YOUR_CHATGPT_API_ENDPOINT';
    const apiKey = 'YOUR_CHATGPT_API_KEY';

    try {
        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${apiKey}`
            },
            body: JSON.stringify({
                model: 'gpt-4-0314', // or whatever model identifier you're using
                messages: [{ role: 'user', content: prompt }],
                temperature: 0.7,
                max_tokens: 1000
            })
        });

        if (!response.ok) {
            throw new Error('Failed to generate routine');
        }

        const data = await response.json();
        const routineData = JSON.parse(data.choices[0].message.content);

        return routineData;
    } catch (error) {
        console.error('Error generating routine:', error);
        return null;
    }
}

// Display routine
function displayRoutine(routine) {
    document.getElementById('loadingSection').classList.add('hidden');
    document.getElementById('resultsSection').classList.remove('hidden');
    document.getElementById('formSection').classList.add('hidden'); // Hide the form

    document.getElementById('routineTitle').textContent = routine.title;
    document.getElementById('routineSubtitle').textContent = routine.subtitle;

    const routineItems = document.getElementById('routineItems');
    routineItems.innerHTML = '';
    routine.schedule.forEach((item, index) => {
        const itemElement = document.createElement('div');
        itemElement.className = 'routine-item flex items-center space-x-4 p-4 bg-white dark:bg-gray-700 rounded-lg shadow-md transition-all duration-300 hover:shadow-lg';
        itemElement.innerHTML = `
            <div class="icon-container flex-shrink-0 w-12 h-12 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center text-blue-500 dark:text-blue-300">
                <i data-lucide="${item.icon}" class="w-6 h-6"></i>
            </div>
            <div class="flex-grow">
                <p class="font-semibold text-lg">${item.time}</p>
                <p class="text-gray-600 dark:text-gray-300">${item.activity}</p>
            </div>
        `;
        routineItems.appendChild(itemElement);
        
        // Add a slight delay to each item for a staggered animation effect
        setTimeout(() => {
            itemElement.classList.add('animate-slide-in');
        }, index * 100);
    });

    // Display the icon word
    const iconWordElement = document.createElement('div');
    iconWordElement.className = 'text-center mt-6 text-2xl font-bold text-blue-600 dark:text-blue-400';
    iconWordElement.textContent = `Routine Theme: ${routine.iconWord}`;
    routineItems.appendChild(iconWordElement);

    // Initialize Lucide icons for the newly added elements
    lucide.createIcons();
}

// Back to form button handler
document.getElementById('backToForm').addEventListener('click', () => {
    document.getElementById('resultsSection').classList.add('hidden');
    document.getElementById('formSection').classList.remove('hidden');
    localStorage.removeItem('userRoutine'); // Clear the stored routine
});

// Check for existing routine on page load
window.addEventListener('load', () => {
    const existingRoutine = localStorage.getItem('userRoutine');
    if (existingRoutine) {
        displayRoutine(JSON.parse(existingRoutine));
    }
});
    </script>
</body>
</html>